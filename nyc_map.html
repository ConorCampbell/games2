<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Map with Markers</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <style>
        html, body, #map {
            height: 100%;
            margin: 0;
        }
        #marker-menu {
            font-family:Roboto;
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: wheat;
            padding: 10px;
            border-radius: 5px;
            border: 2px solid green;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }

        .marker-btn {
            margin: 5px;
            padding: 5px 10px;
            cursor: pointer;
            border: none;
            border-radius: 3px;
            color: white;
        }
        .red { background: red; }
        .blue { background: blue; }
        .green { background: green; }
        .yellow { background: orange; }
    </style>
</head>
<body>

<!-- Marker selection menu -->
<div id="marker-menu">
    <strong>Select Marker:</strong><br>
    <button class="marker-btn red" data-type="red">Red</button>
    <button class="marker-btn blue" data-type="blue">Blue</button>
    <button class="marker-btn green" data-type="green">Green</button>
    <button class="marker-btn yellow" data-type="yellow">Yellow</button>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {

        var map = L.map('map').setView([0, 0], 16);

        // Add OpenStreetMap tile layer

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        // Marker Icons (Colored)
        var markerIcons = {
            red: L.icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png', iconSize: [25, 41], iconAnchor: [12, 41] }),
            blue: L.icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png', iconSize: [25, 41], iconAnchor: [12, 41] }),
            green: L.icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png', iconSize: [25, 41], iconAnchor: [12, 41] }),
            yellow: L.icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-gold.png', iconSize: [25, 41], iconAnchor: [12, 41] })
        };

        var selectedMarkerType = null;
        var activeMarker = null;

        // Handle marker selection
        document.querySelectorAll('.marker-btn').forEach(button => {
            button.addEventListener('click', function () {
                selectedMarkerType = this.dataset.type;
            });
        });

        // Place marker on map click
        map.on('click', function (e) {

            if (!selectedMarkerType) {
                // alert("Please select a marker type first!");
                return;
            }

            // if (activeMarker) {
            //     map.removeLayer(activeMarker);
            // }

            activeMarker = L.marker(e.latlng, {
                icon: markerIcons[selectedMarkerType],
                draggable: true
            }).addTo(map);

            activeMarker.bindPopup(`You placed a ${selectedMarkerType} marker`)

            selectedMarkerType = null;

            //.openPopup();

        });

        // Center map on user's location
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                var lat = position.coords.latitude;
                var lng = position.coords.longitude;

                map.setView([lat, lng], 16);

                 L.marker([lat, lng]).addTo(map)
                    .bindPopup("You are here!")

            }, function () {
                alert("Geolocation access denied. Defaulting to (0,0).");
            });
        } else {
            alert("Geolocation is not supported by your browser.");
        }
    });
</script>

</body>
</html>
